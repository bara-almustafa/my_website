---
description: >-
  Below is a concise, provider-agnostic methodology you can add directly to a
  GitBook, with provider-specific notes for AWS, Azure, and GCP, and tooling
  suggestions.
cover: ../.gitbook/assets/cloud.webp
coverY: 0
---

# Cloud Penetration Testing Methodology

### 1) Pre-engagement, Scope, and Rules of Engagement <a href="#id-1-pre-engagement-scope-and-rules-of-engagement" id="id-1-pre-engagement-scope-and-rules-of-engagement"></a>

* Define scope: accounts/subscriptions/projects, regions, services, apps, APIs, VMs, serverless, containers, identities, and third-party integrations.
* Clarify testing style: black-box, gray-box, or white-box; list out-of-scope items (e.g., provider-managed internals, DoS, noisy load tests).
* Confirm cloud-provider policies: customer-controlled resources can be tested; avoid activities that impact provider infrastructure; follow acceptable use policies.
* Establish legal, timeframe, safe words, contact channels, data handling, and retest windows.

### 2) Asset Inventory and Reconnaissance <a href="#id-2-asset-inventory-and-reconnaissance" id="id-2-asset-inventory-and-reconnaissance"></a>

* Build inventory: enumerate domains, subdomains, public IPs, APIs, storage buckets, repos, images, registries, serverless endpoints, Kubernetes control planes, identities, and roles.
* Identify tenants/projects/subscriptions and high-value assets; map attack surface and trust boundaries.
* Gather OSINT: emails/usernames, public blobs/buckets, leaked keys/tokens, and metadata exposures.
* Useful tooling: Scout Suite, CloudMapper, Pacu (AWS); Azucar, MicroBurst, Stormspotter (Azure); gcloud, G-Scout, Forseti, GCPBucketBrute (GCP).

### 3) Configuration and Posture Review <a href="#id-3-configuration-and-posture-review" id="id-3-configuration-and-posture-review"></a>

* Review IAM: excessive permissions, wildcard actions, trust policies, privilege escalation paths, role assumption, and service account sprawl.
* Check network: VPC/VNet segmentation, security groups/NSGs/firewalls, exposed management ports, peering and egress controls.
* Storage/data: public buckets/containers, encryption at rest/in transit, KMS/keys management, access policies.
* Logging/monitoring: CloudTrail/Azure Activity Log/GCP Audit Logs enabled and retained; alerting configured; detections for key events.
* Provider-native checks: AWS Inspector/Security Hub, Azure Security Center/Defender for Cloud, GCP Security Command Center.

### 4) Vulnerability Assessment (Automated + Manual) <a href="#id-4-vulnerability-assessment-automated--manual" id="id-4-vulnerability-assessment-automated--manual"></a>

* Run authenticated and unauthenticated scans against in-scope hosts, apps, APIs, containers, and serverless endpoints; verify findings manually to reduce false positives.
* Prioritize business-critical services, internet-exposed assets, and identity perimeter weaknesses.
* Use general scanners in cloud mode (e.g., Tenable/Nessus/Qualys/Astra) alongside provider-native scanners.

### 5) Identity & Access Testing <a href="#id-5-identity--access-testing" id="id-5-identity--access-testing"></a>

* External perimeter: password spraying (with rate-limit/MFA care), credential stuffing using approved lists, enumeration of valid users/tenants/MFA states where permitted.
* Token and role abuse: inspect managed identities/instance profiles/service accounts for privilege escalation and lateral movement; test role assumptions and chained trusts.
* App-to-cloud pivot: exploit web/app flaws to obtain cloud tokens (e.g., managed identity) and expand cloud access.

### 6) Application, API, and Service Testing <a href="#id-6-application-api-and-service-testing" id="id-6-application-api-and-service-testing"></a>

* Web/API testing per OWASP WSTG: authN/authZ, injections, SSRF to cloud metadata endpoints, misused headers, insecure deserialization, and rate limiting.
* API keys/secrets exposure in repos, images, buckets, and environment variables; verify rotation and scoping.
* Serverless pitfalls: permissive triggers, overprivileged function roles, insecure event sources, SSRF to metadata, secrets in env vars.
* Container/K8s: image hardening, registry access, privilege settings, network policies, secrets, and control-plane exposure.

### 7) Exploitation and Lateral Movement <a href="#id-7-exploitation-and-lateral-movement" id="id-7-exploitation-and-lateral-movement"></a>

* Exploit validated misconfigurations and vulnerabilities with minimal impact to demonstrate risk: data access from storage, role assumption, command execution in compute, and control-plane actions.
* Lateral movement via service principals/roles, instance profiles, and workload identities; attempt privilege escalation chains responsibly.
* Respect no-DoS/no-stress constraints; avoid impacting other tenants; document all steps and artifacts.

### 8) Persistence, Evasion, and Detection (By Agreement) <a href="#id-8-persistence-evasion-and-detection-by-agreement" id="id-8-persistence-evasion-and-detection-by-agreement"></a>

* If permitted, test realistic persistence (e.g., scheduled functions, role trust changes, access keys) and assess detection efficacy and response timelines.
* Validate monitoring/alerting on key activities: new keys, role changes, public exposure, and anomalous API usage.

### 9) Reporting and Risk Treatment <a href="#id-9-reporting-and-risk-treatment" id="id-9-reporting-and-risk-treatment"></a>

* Deliver executive summary, methodology, scope, limitations, detailed findings with PoC, evidence, affected resources, CVSS, blast radius, and business impact; provide prioritized remediation with cloud-native fixes and guardrails.
* Map to compliance (SOC 2, HIPAA, ISO 27001) where helpful; include diagrams and kill-chain paths.
* Provide immediate containment advice for high/critical issues and defense-in-depth recommendations.

### 10) Remediation Support and Retesting <a href="#id-10-remediation-support-and-retesting" id="id-10-remediation-support-and-retesting"></a>

* Collaborate on fixes: least-privilege IAM, hardened network controls, encryption and key rotation, secret management, per-service guardrails, policy-as-code, CI/CD checks.
* Retest to verify remediation and update evidence; agree on continuous assessment cadence.

***

### Common Cloud Findings to Target <a href="#common-cloud-findings-to-target" id="common-cloud-findings-to-target"></a>

* Public storage/buckets/containers exposing sensitive data.
* Overprivileged roles/service accounts and insecure trust policies enabling escalation.
* Flat networks, permissive security groups, exposed admin ports, weak WAF/API gateways.
* Missing/weak MFA, password policies, legacy auth protocols, and token mismanagement.
* Serverless/container misconfigurations, hardcoded secrets, and vulnerable images.
* Insufficient logging/monitoring: disabled trails, short retention, no actionable alerts.

***

### AWS, Azure, and GCP Notes <a href="#aws-azure-and-gcp-notes" id="aws-azure-and-gcp-notes"></a>

* AWS:
  * Tools: AWS CLI, Scout Suite, Pacu, CloudMapper, S3Scanner.
  * Authorization: testing customer-controlled resources is permitted without prior approval; avoid disruptive actions and respect shared responsibility.
* Azure (Azure AD and Azure resources):
  * Tools: Azure CLI/PowerShell, Azucar, MicroBurst, Stormspotter.
  * Azure AD kill chain: recon (tenant, users), initial access (spray, illicit consent), enumeration, lateral movement via roles/apps, persistence, and managed identity abuse paths.
  * Microsoft guidance on pen testing in Azure is available with constraints and process overview.
* GCP:
  * Tools: gcloud, G-Scout, Forseti, GCPBucketBrute.
  * Typical out-of-scope: Google-managed internals (e.g., BigQuery internals) and any cross-tenant or disruptive testing; focus on customer-deployed resources.

***

### Lightweight Checklist (Drop-in) <a href="#lightweight-checklist-drop-in" id="lightweight-checklist-drop-in"></a>

* Pre-engagement: scope, style, approvals, provider rules.
* Inventory: accounts/projects, services, identities, external surface.
* Config review: IAM, network, storage, crypto, logging.
* VAPT: automated scans + manual verification.
* Identity: spraying (if allowed), role assumptions, token abuse.
* Apps/APIs: OWASP WSTG, SSRF to metadata, secret leaks.
* Serverless/containers/K8s: roles, triggers, images, secrets, RBAC.
* Exploitation: minimal-impact PoCs, lateral movement paths.
* Reporting: CVSS, blast radius, remediation, compliance mapping.
* Retest: verify fixes, propose guardrails and cadence.

***

### References for Further Detail (for internal use/citation basis in this methodology) <a href="#references-for-further-detail-for-internal-usecita" id="references-for-further-detail-for-internal-usecita"></a>

* Stepwise cloud methodology, tooling and reporting structure.
* OWASP WSTG methodology alignment for app/API testing.
* Azure AD-specific kill chain and techniques.
* GCP pentest phases and out-of-scope examples.
* Authorization rules and shared responsibility clarifications.
* Common cloud weaknesses and assessment checklist items.
* Lifecycle framing and pre-engagement steps.

All provider policies and service names should be verified against the latest official documentation during scoping and before execution to ensure compliance with current authorization requirements and acceptable use constraints.
